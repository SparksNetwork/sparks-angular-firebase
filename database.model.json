{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "description": "Sparks.Network data model",
    "type": "object",
    "required": [
        "project", "opp", "contrib", "benefit", "team", "oppAllowedTeam"
    ],
    "properties": {
        "project": {
            "type": "object",
            "required": [
                "$key"
            ],
            "properties": {
                "$key": {
                    "type": "object",
                    "$ref": "#/definitions/projectDef"
                }
            }
        },
        "opp": {
            "type": "object",
            "required": [
                "$key"
            ],
            "properties": {
                "$key": {
                    "type": "object",
                    "$ref": "#/definitions/oppDef"
                }
            }
        },
        "contrib": {
            "type": "object",
            "required": [
                "$key"
            ],
            "properties": {
                "$key": {
                    "type": "object",
                    "$ref": "#/definitions/contribDef"
                }
            }
        },
        "benefit": {
            "type": "object",
            "required": [
                "$key"
            ],
            "properties": {
                "$key": {
                    "type": "object",
                    "$ref": "#/definitions/benefitDef"
                }
            }
        },
        "team": {
            "type": "object",
            "required": [
                "$key"
            ],
            "properties": {
                "$key": {
                    "type": "object",
                    "$ref": "#/definitions/teamDef"
                }
            }
        },
        "oppAllowedTeam": {
            "type": "object",
            "required": [
                "$key"
            ],
            "properties": {
                "$key": {
                    "type": "object",
                    "$ref": "#/definitions/oppAllowedTeamDef"
                }
            }
        }
    },
    "definitions": {
        "projectDef": {
            "required": [
                "title", "description", "startDateTime", "location", "organizer", "maxKarmaPoints", "images", "projectPageUrl"
            ],
            "properties": {
                "title": { "type": "string" },
                "description": { "type": "string" },
                "projectType": { "type": "integer" }, 
                "startDateTime": {
                    "type": "string",
                    "format": "date-time"
                },
                "endDateTime": {
                    "type": "string",
                    "format": "date-time"
                },
                "location": {
                    "type": "object",
                    "properties": {
                        "name": { "type": "string" },
                        "address": { "type": "string" },
                        "city": { "type": "string" },
                        "state": { "type": "string" },
                        "latitude": { "type": "number" },
                        "longitude": { "type": "number" }
                    }
                },
                "images": {
                    "type": "array",
                    "items": { 
                        "type": "object",
                        "required": [ "imageUrl"],
                         "properties": {
                             "imageUrl": { "type": "string", "format": "uri" }
                         }
                    }
                },
                "maxKarmaPoints": { "type": "integer" },
                "shareKarmaPoints": { "type": "integer" },
                "organizer": {
                    "type": "object",
                    "required": [ "organizerKey", "name", "organization", "imageUrl"],
                    "properties": {
                        "organizerKey": { "type": "string" },
                        "name": { "type": "string"},
                        "organization": { "type": "string"},
                        "imageUrl": { "type": "string", "format": "uri" }
                    }
                },
                "projectPageUrl": { "type": "string", "format": "uri" },
                "communityBenefit": { "type": "string"}
            }
        },
        "oppDef": {
            "required": [
                "projectKey", "title", "description"
            ],
            "properties": {
                "projectKey": { "type": "string" },
                "title": { "type": "string" },
                "description": { "type": "string" },
                "icon": { "type": "string" },
                "karma": { "type": "integer" },
                "contribValue": { "type": "number" },
                "benefitValue": { "type": "number" }
            }
        },
        "contribDef": {
            "required": [
                "oppKey", "title", "description"
            ],
            "properties": {
                "oppKey": { "type": "string" },
                "type": { "type": "integer" },
                "title": { "type": "string" },
                "description": { "type": "string" },
                "icon": { "type": "string" },
                "shiftMinLength": { "type": "integer" },
                "shiftMaxLength": { "type": "integer" }
            }
        },
        "benefitDef": {
            "required": [
                "oppKey", "title", "description"
            ],
            "properties": {
                "oppKey": { "type": "string" },
                "type": { "type": "integer" },
                "title": { "type": "string" },
                "description": { "type": "string" },
                "icon": { "type": "string" }
            }
        },
        "teamDef":{
            "required": [
                "title", "description", "oppKey"
            ],
            "properties": {
                "title": { "$ref": "#/constraints/nonEmptyString" },
                "description": { "$ref": "#/constraints/nonEmptyString" },               
                "icon": { "type": "string" },
                "oppKey": { "$ref": "#/constraints/nonEmptyString" }
            }
        },
        "oppAllowedTeamDef": {
            "required": [
                "oppKey", "teamKey", "team"
            ],
            "properties": {
                "oppKey": { "$ref": "#/constraints/nonEmptyString" },
                "teamKey": { "$ref": "#/constraints/nonEmptyString" },
                "team": {
                    "type": "object",
                    "required": [ "title", "description"],
                    "properties": {
                        "title": { "$ref": "#/constraints/nonEmptyString" },
                        "description": { "$ref": "#/constraints/nonEmptyString" },               
                        "icon": { "type": "string" }
                    }
                }
            }
        }
    },
    "constraints": {
        "nonEmptyString": {
            "type": "string",
            "minLength": 1
        }
    }
}